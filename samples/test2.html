<!doctype html>
<html>
    <head>
        <title>tests</title>

        <meta charset="utf-8">

        <script type="text/javascript" src="/Ink/1/"></script>
        <!--<script type="text/javascript">Ink.setPath('Ink', '/Ink/');</script>-->

        <style type="text/css">
            body {
                font-family: sans-serif;
            }

            .foo{
                background-color: blue;
                display: block;
            }

            .bar{
                background-color: red;
            }

            img {
                max-width: 128px;
                max-height: 128px;
            }
        </style>
    </head>

    <body>
        <h1 id="h1">Teste de coisas</h1>
        <h2 id="h2">Changed color to red after document loaded</h2>
        <div>1</div>
        <div>2</div>

        <script type="text/javascript">
            Ink.requireModules(
                ['Ink.Dom.Loaded_1', 'Ink.Dom.Css_1', 'Ink.Dom.Element_1', 'Ink.Dom.Event_1'],
                function(Loaded, Css, Elm, Event) {
                    Ink.Dom.Loaded.run(function() {
                        Css.addClassName('h2', 'bar');
                        Css.changeFontSize('body', 10);
                        //Css.changeFontSize('#h2', 0.5, '*');
                    });

                    var newDiv = Elm.create('div', {id:'mydiv', "class":"foo"});
                    Elm.appendHTML(newDiv, '<p>Hello World - now click me<'+'/p>');
                    document.body.appendChild(newDiv);
                    console.log(Elm.offset2(newDiv));

                    Event.observe(newDiv, 'click', function(ev) {
                        alert('clicked => '+ Ink.Dom.Event.element(ev));
                    });
                }
            );

            Ink.requireModules(
                ['Ink.Util.Array_1', 'Ink.Util.Url_1', 'Ink.Util.Date_1', 'Ink.Util.Validator_1'],
                function(UArray, Url, UDate, Validator) {
                    var myA = [4, 6, 9, 1];
                    console.log('inArray 9 => ' + UArray.inArray(9, myA));
                    console.log('inArray 19 => ' + UArray.inArray(19, myA));
                    console.log('shuffle => ' + UArray.shuffle(myA));

                    console.log('URL => ' + Url.getUrl());
                    console.log('parseURL => ', Url.parseUrl(location.href));
                    console.log('queryString => ', Url.getQueryString());

                    console.log('Date => ', UDate.get("Y-m-d H:i:s"));

                    console.log('Validator: pt phone 962057655', Validator.isPTPhone('962057655'));
                    console.log('Validator: pt phone 29872979', Validator.isPTPhone('29872979'));
                    console.log('Validator: mail inkdev@sapo.pt', Validator.mail('inkdev@sapo.pt'));
                    console.log('Validator: mail inkdev@sapopt', Validator.mail('inkdev@sapopt'));
                }
            );

            Ink.requireModules(
                ['Ink.Net.Ajax_1', 'Ink.Net.JsonP_1'],
                function(Ajax, JsonP) {
                    new Ajax('./end.php', {
                        method:'get',
                        onSuccess: function(obj) {
                            console.log(obj);
                            console.log(obj.responseText);
                            console.log(obj.responseJSON);
                        }
                    });

                    Ajax.load('end.php', function(txt) {
                        console.log('Ajax.load => '+ txt);
                    });

                    new JsonP('http://api.flickr.com/services/feeds/photos_public.gne', {
                            params: {
                                tags:       'cat',
                                tagmode:    'any',
                                format:     'json'
                            },
                            onComplete: function(data) {
                                var h = [];

                                data.items.forEach(function(item) {
                                    h = h.concat(['<a title="', item.title, '" href="', item.link, '"><img src="', item.media.m, '"><','/a>']);
                                });

                                document.body.insertAdjacentHTML('beforeend', h.join(''));
                                console.log('JsonP', data);
                            }
                        }
                    );
                }
            );
        </script>
    </body>
</html>
